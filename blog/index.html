<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="description" content="Code, Biology and bits of life...">
    <meta name="viewport" content="width=device-width">
    <title>Vivek Rai | Vivek Rai</title>

    
            <link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">

    
            <link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">

      <link rel="canonical" href="https://vivekiitkgp.github.io/blog/">



    
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    },
    displayAlign: 'center', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script>

        <!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->

    
<link href="https://fonts.googleapis.com/css?family=PT+Serif" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=PT+Sans" rel="stylesheet" type="text/css">





</head>
<body>
<div class="container" id="container">
    <!--Body content-->
    <!--End of body content-->
    <div>
    <a href="https://vivekiitkgp.github.io/"><h1>Vivek Rai</h1></a>
    </div>
    <hr>
    <div id="content">
        
        
        <div class="postdiv">
        <a href="creating-graphical-overview-with-d3.html"><h2>Creating graphical overview with D3</h2></a>
        <p>This is a follow up of the <a class="reference external" href="understanding-blast-output.html">previous post</a>
where I was working with understanding and parsing the BLAST output data for
creating the data layer in SequenceServer. A very critical and often demanded
feature for the application was the ability to have a graphical overview of all
the obtained hits. It had been sitting on project's urgent list for quite a
long time and couldn't be delayed any longer. So, I assigned this task to
myself after having a nod from the project maintainer Priyam.</p>
<p class="more"><a href="creating-graphical-overview-with-d3.html">Read more…</a></p>
        <p>
        </p>
</div>
        <div class="postmeta">
        <small> § 
            <span class="dateline"><a href="creating-graphical-overview-with-d3.html" rel="bookmark"><time class="published dt-published" datetime="2014-08-22T07:22:27+05:30" itemprop="datePublished" title="Publication date">2014-08-22 07:22</time></a></span>
        </small>
             · 
        
    <a href="creating-graphical-overview-with-d3.html#disqus_thread" data-disqus-identifier="cache/posts/creating-graphical-overview-with-d3.html">Comments</a>


             · d3.js
             · javascript
             · jquery
             · sequenceserver
        </div>
        <hr>
        <div class="postdiv">
        <a href="understanding-blast-output.html"><h2>Understanding BLAST Output</h2></a>
        <p>In the last post, I mentioned about a project I was trying to work on -
<a class="reference external" href="http://www.sequenceserver.com">SequenceServer</a>. Also, in the end I
said that I would be writing about the BLAST algorithm (which is the
backbone of this project) and how does it works so efficiently in
producing alignments even with very long sequences. However, In this
post I would like to talk about BLAST program and it's output before we
go into the algorithm some time later.</p>
<p>After talking to <a class="reference external" href="https://github.com/yeban">Priyam</a> (one of the
project collaborators), I decided to work towards solving the <a class="reference external" href="https://github.com/yannickwurm/sequenceserver/issues/21">issue
21</a>, which
in turn would help us to solve a large number of other dependent issues
as well. This was supposed to be a major improvement and I really liked
the idea of it. Especially since it was concerned with understanding the
BLAST program and its output format.</p>
<p><em>Background</em>: <a class="reference external" href="https://github.com/yannickwurm/sequenceserver/issues/21">Issue
21</a> deals
with displaying an overview graphic for the output results obtained from
blasting. This is a nice feature as it adds more towards visualizing and
understanding the data easily (than going over a large number of hits in
many cases). The problem however is that because of the hacky way in
which the current implementation worked for displaying the final output
results, it was not very easy to work with generation of visuals. The
data generated from BLAST output had to be parsed first into a data
layer and then interfaced with other features like displaying overview
graphic or other rich information. This required three things from my
side - Ruby, BLAST and Patience.</p>
<div class="section" id="x-part-i">
<h2>[x] Part I</h2>
<p><strong>BLAST Output</strong>: The blast output format can be reconfigured using the
<tt class="docutils literal">outfmt</tt> option which is described in the NCBI's <a class="reference external" href="www.ncbi.nlm.nih.gov/books/NBK1763/#!po=91.5094">BLAST
Manual</a>.
The sample XML output (standard settings) has the following structure
(for a real example
<a class="reference external" href="https://gist.github.com/vivekiitkgp/e9fb422f177bec7f56b6#file-blast-xml">blast.xml</a>):</p>
<pre class="code xml literal-block">
.?xml version="1.0"?&gt;
<span class="cp">&lt;!DOCTYPE BlastOutput PUBLIC "-//NCBI//NCBI BlastOutput/EN" "http://www.ncbi.nlm.nih.gov/dtd/NCBI_BlastOutput.dtd"&gt;</span>
<span class="nt">&lt;BlastOutput&gt;</span>
  <span class="nt">&lt;BlastOutput_program&gt;</span>
  <span class="nt">&lt;BlastOutput_version&gt;</span>
  <span class="nt">&lt;BlastOutput_reference&gt;</span>
  <span class="nt">&lt;BlastOutput_db&gt;</span>
  <span class="nt">&lt;BlastOutput_query-ID&gt;</span>
  <span class="nt">&lt;BlastOutput_query-def&gt;</span>
  <span class="nt">&lt;BlastOutput_query-len&gt;</span>
  <span class="nt">&lt;BlastOutput_param&gt;</span>
    <span class="nt">&lt;Parameters&gt;</span>
      <span class="nt">&lt;Parameters_matrix&gt;</span>
      <span class="nt">&lt;Parameters_expect&gt;</span>
      <span class="nt">&lt;Parameters_gap-open&gt;</span>
      <span class="nt">&lt;Parameters_gap-extend&gt;</span>
      <span class="nt">&lt;Parameters_filter&gt;</span>
    <span class="nt">&lt;/Parameters&gt;</span>
  <span class="nt">&lt;/BlastOutput_param&gt;</span>
<span class="nt">&lt;BlastOutput_iterations&gt;</span>
<span class="nt">&lt;Iteration&gt;</span>
  -- Iteration details --
<span class="nt">&lt;Iteration_hits&gt;</span>
<span class="nt">&lt;Hit&gt;</span>
  <span class="nt">&lt;Hit_num&gt;</span>
  <span class="nt">&lt;Hit_id&gt;</span>
  <span class="nt">&lt;Hit_def&gt;</span>
  <span class="nt">&lt;Hit_accession&gt;</span>
  <span class="nt">&lt;Hit_len&gt;</span>
  <span class="nt">&lt;Hit_hsps&gt;</span>
    <span class="nt">&lt;Hsp&gt;</span>
  -- HSP Details --
    <span class="nt">&lt;/Hsp&gt;</span>
  <span class="nt">&lt;/Hit_hsps&gt;</span>
<span class="nt">&lt;/Hit&gt;</span>
<span class="nt">&lt;Hit&gt;</span> <span class="nt">&lt;/Hit&gt;</span>
<span class="nt">&lt;/Iteration_hits&gt;</span>
<span class="nt">&lt;Iteration_stat&gt;</span>
  -- Statistics about Query --
<span class="nt">&lt;/Iteration_stat&gt;</span>
<span class="nt">&lt;/Iteration&gt;</span>
<span class="nt">&lt;/BlastOutput_iterations&gt;</span>
<span class="nt">&lt;/BlastOutput&gt;</span>
</pre>
<p>The XML output is as detailed as it could be including all the
information about Hit's
<a class="reference external" href="https://genomevolution.org/wiki/index.php/High-scoring_segment_pair">HSP</a>,
the <tt class="docutils literal">query database</tt>, <tt class="docutils literal">alignment lengths</tt>, the
<tt class="docutils literal">query and aligned sequences</tt> along with the matches between them, and
<tt class="docutils literal">query statistics</tt>. This is as useful as it could be and helps to
generate very detailed statistics and overview too. I would recommend
one to look at the given example of blast.xml to understand what kind of
data is generated. To parse this generated XML output easily, I used the
<a class="reference external" href="https://rubygems.org/gems/ox">Ox</a> rubygem, which is a simple and
<a class="reference external" href="http://www.ohler.com/dev/xml_with_ruby/xml_with_ruby.html">faster</a>
alternative of other XML parsers available in Ruby. In the beginning, I
generated a simple Hash out of this parsed data using recursive
traversal along the elements.</p>
<pre class="code ruby literal-block">
<span class="ln"> 1 </span><span class="k">def</span> <span class="nf">report!</span>
<span class="ln"> 2 </span>    <span class="c1"># Generates BLAST report which one or more multiple Query objects</span>
<span class="ln"> 3 </span>    <span class="c1"># based on the blast query string.</span>
<span class="ln"> 4 </span>    <span class="n">parsed_out</span> <span class="o">=</span> <span class="no">Ox</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="vi">@result</span><span class="p">)</span>
<span class="ln"> 5 </span>    <span class="n">hashed_out</span> <span class="o">=</span> <span class="n">node_to_dict</span><span class="p">(</span><span class="n">parsed_out</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
<span class="ln"> 6 </span>    <span class="vi">@program</span> <span class="o">=</span> <span class="n">hashed_out</span><span class="o">[</span><span class="s2">"BlastOutput_program"</span><span class="o">]</span>
<span class="ln"> 7 </span>    <span class="vi">@querydb</span> <span class="o">=</span> <span class="n">hashed_out</span><span class="o">[</span><span class="s2">"BlastOutput_db"</span><span class="o">]</span>
<span class="ln"> 8 </span>
<span class="ln"> 9 </span>    <span class="n">hashed_out</span><span class="o">[</span><span class="s2">"BlastOutput_iterations"</span><span class="o">].</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">n</span><span class="o">|</span>
<span class="ln">10 </span>        <span class="vi">@queries</span> <span class="o">||=</span> <span class="p">{}</span>
<span class="ln">11 </span>        <span class="vi">@queries</span><span class="o">[</span><span class="n">n</span><span class="o">[</span><span class="mi">2</span><span class="o">]]</span> <span class="o">=</span> <span class="no">Query</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">n</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">,</span> <span class="n">n</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">,</span> <span class="n">n</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="p">,</span> <span class="p">{},</span> <span class="n">n</span><span class="o">[</span><span class="mi">5</span><span class="o">][</span><span class="s2">"Statistics"</span><span class="o">]</span><span class="p">)</span>
<span class="ln">12 </span>
<span class="ln">13 </span>        <span class="c1"># Ensure a hit object is received. No hits, returns a newline.</span>
<span class="ln">14 </span>        <span class="c1"># Note that checking to "\n" doesn't work since n[4] = ["\n"]</span>
<span class="ln">15 </span>        <span class="k">if</span> <span class="n">n</span><span class="o">[</span><span class="mi">4</span><span class="o">]==[</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">]</span>
<span class="ln">16 </span>            <span class="vi">@queries</span><span class="o">[</span><span class="n">n</span><span class="o">[</span><span class="mi">2</span><span class="o">]][</span><span class="ss">:hits</span><span class="o">]</span> <span class="o">=</span> <span class="s2">"No hits found."</span>
<span class="ln">17 </span>            <span class="nb">puts</span> <span class="s2">"true"</span>
<span class="ln">18 </span>        <span class="k">else</span>
<span class="ln">19 </span>            <span class="n">n</span><span class="o">[</span><span class="mi">4</span><span class="o">].</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">hits</span><span class="o">|</span>
<span class="ln">20 </span>                <span class="vi">@queries</span><span class="o">[</span><span class="n">n</span><span class="o">[</span><span class="mi">2</span><span class="o">]][</span><span class="ss">:hits</span><span class="o">][</span><span class="n">hits</span><span class="o">[</span><span class="mi">1</span><span class="o">]]</span> <span class="o">=</span> <span class="no">Hit</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">hits</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">,</span> <span class="n">hits</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">,</span> <span class="n">hits</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">,\</span>
<span class="ln">21 </span>                                                <span class="n">hits</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="p">,</span> <span class="n">hits</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="p">,</span> <span class="p">{})</span>
<span class="ln">22 </span>                <span class="vi">@queries</span><span class="o">[</span><span class="n">n</span><span class="o">[</span><span class="mi">2</span><span class="o">]][</span><span class="ss">:hits</span><span class="o">][</span><span class="n">hits</span><span class="o">[</span><span class="mi">1</span><span class="o">]][</span><span class="ss">:hsp</span><span class="o">]</span> <span class="o">=</span> <span class="no">HSP</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="o">*</span><span class="n">hits</span><span class="o">[</span><span class="mi">5</span><span class="o">][</span><span class="s2">"Hsp"</span><span class="o">].</span><span class="n">values</span><span class="p">)</span>
<span class="ln">23 </span>            <span class="k">end</span>
<span class="ln">24 </span>        <span class="k">end</span>
<span class="ln">25 </span>    <span class="k">end</span>
<span class="ln">26 </span><span class="k">end</span>
</pre>
<p>This Hash is then used for easy templating (using
<a class="reference external" href="http://ruby-doc.org/stdlib-1.9.3/libdoc/erb/rdoc/ERB.html">erb</a>) and
display of results in a more elegant and modular way. This keeps the
data at one place which can then be used for overview graphic display or
integration of other features and bug fixes in near future. All my work
related to this can be found at
<a class="reference external" href="https://github.com/vivekiitkgp/sequenceserver/tree/issue21">@issue21</a>
branch. The code written till now, is very premature and <em>just</em> works. I
plan to refactor it majorily and incorporate some very nice features of
Ruby language (which I am desperately trying to understand).</p>
<p><a class="reference external" href="https://drive.google.com/file/d/0B3eGCB261PalWTJnODloLXAtdGM/edit?usp=sharing">Here</a>
is a snapshot of what current output looks like, when SS is run.</p>
</div>
<div class="section" id="o-part-ii">
<h2>[O] Part II</h2>
<p>The second part of this task deals with actually displaying the overview
graphic for the hits obtained using SS. To give an idea of what it looks
like, see <a class="reference external" href="http://www.biodalliance.org/">here</a> and
<a class="reference external" href="http://canvasxpress.org/genome.html">here</a>. The target is to display
similar graphic (but simple and easy to load/configure) for each hit in
the SS's output. I am yet to start working on and possibly the next post
could be derived out of that work.</p>
<p>I would be very glad if you drop by to review my code and send in any
suggestions. Feel free to reach me by whatever means.</p>
</div>
        <p>
        </p>
</div>
        <div class="postmeta">
        <small> § 
            <span class="dateline"><a href="understanding-blast-output.html" rel="bookmark"><time class="published dt-published" datetime="2014-07-13T02:47:45+05:30" itemprop="datePublished" title="Publication date">2014-07-13 02:47</time></a></span>
        </small>
             · 
        
    <a href="understanding-blast-output.html#disqus_thread" data-disqus-identifier="cache/posts/understanding-blast-output.html">Comments</a>


             · blast
             · ruby
             · sequenceserver
        </div>
        <hr>
        <div class="postdiv">
        <a href="easy-blast-tool-sequenceserver.html"><h2>Easy BLAST tool - SequenceServer</h2></a>
        <p>Contributing to open source is quite an exciting journey. I embarked upon this
mission recently with few contributions to <a class="reference external" href="http://www.sequenceserver.com/">SequenceServer - A BLAST tool</a>, which lets you set up custom BLAST+ server to perform BLAST queries with your
own database locally through a web interface. For those who are not familiar
with <strong>BLAST</strong> or Basic Local Search Alignment Tool <a class="citation-reference" href="easy-blast-tool-sequenceserver.html#paper" id="id1">[paper]</a> - it is an algorithm which allows
quick comparison of biological sequence information which are long strings consisting
of amino acids (in case of proteins) or nucleotides (in case of nucleic acids).
It is exceedingly used by biologists all over the world to study newer
organisms, discovery of genes and finding similarity between proteins and so
on. One can see a working instance of the tool at <a class="reference external" href="http://antgenomes.org/blast">Ant Genomes</a> website, maintained by one of the developers
and Professor at Queen Mary University London, <a class="reference external" href="http://www.sbcs.qmul.ac.uk/staff/yannickwurm.html">Yannick Wurm</a>. He's also the overseerer of the project.</p>
<p class="more"><a href="easy-blast-tool-sequenceserver.html">Read more…</a></p>
        <p>
        </p>
</div>
        <div class="postmeta">
        <small> § 
            <span class="dateline"><a href="easy-blast-tool-sequenceserver.html" rel="bookmark"><time class="published dt-published" datetime="2014-05-26T16:50:16+05:30" itemprop="datePublished" title="Publication date">2014-05-26 16:50</time></a></span>
        </small>
             · 
        
    <a href="easy-blast-tool-sequenceserver.html#disqus_thread" data-disqus-identifier="cache/posts/easy-blast-tool-sequenceserver.html">Comments</a>


             · alignment
             · biology
             · blast
             · genes
             · sequenceserver
        </div>
        <hr>
        <div class="postdiv">
        <a href="blogging-is-fun.html"><h2>Blogging is fun!</h2></a>
        <p>Writing a blog and personalized webpage had been one of primary tasks on my
mind for quite a long time. However, Always I was caught in some acitivity
thereby preventing it to happen. Finally, after lurking through many
static website generators, I decided to go ahead with the <a class="reference external" href="http://getnikola.com">Nikola</a> and Github
Pages pair as the best combination. Static websites are easy to maintain,
fun, and simply effective for most of my needs. It took some time to get hold
of how these work but in the process I learned about <a class="reference external" href="https://en.wikipedia.org/wiki/Web_template_system">templating engines</a>,
few javascript libraries and how they are used.</p>
<p>Like all my other projects, the source code for this site is also made
available on <a class="reference external" href="https://github.com/vivekiitkgp/vivekiitkgp.github.io/">Github</a>. Obviously, whatever I have created is very premature
and just a working solution. If anyone has anything to say, just drop in an email
or fork the site and send me a pull request. I would be happy to accept constructive
changes. In the meantime, the looks and structure of the site will be subjected to frequent
modifications.</p>
        <p>
        </p>
</div>
        <div class="postmeta">
        <small> § 
            <span class="dateline"><a href="blogging-is-fun.html" rel="bookmark"><time class="published dt-published" datetime="2014-05-03T18:41:08+05:30" itemprop="datePublished" title="Publication date">2014-05-03 18:41</time></a></span>
        </small>
             · 
        
    <a href="blogging-is-fun.html#disqus_thread" data-disqus-identifier="cache/posts/blogging-is-fun.html">Comments</a>


        </div>
        <hr>
    

    
        
       <script>var disqus_shortname="vivekiitkgp";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>


	


    </div>
    <div class="row-fluid">
        <div class="span6" style="text-align: right; border-right: 2px solid #ccc; padding-right: 20px;">
            <ul class="unstyled bottom">
                        <li class="active">
<a href=".">Blog</a>
                        </li>
<li>
<a href="../resume.html">Resume</a>
                        </li>
<li>
<a href="../rss.xml">RSS</a>
                
            </li>
</ul>
        </div>
        <div class="span6" style="margin-left: 20px;">
            <ul class="unstyled bottom">
            
            
             
            <li>Shares: <div id="share"></div>
</li>
            </ul>
            <div>
            
            </div>
        </div>
    </div>
    <hr>
    <div class="footer">
    Contents © 2014         <a href="mailto:vivekrai.iitkgp@gmail.com">Vivek Rai</a><a href="https://plus.google.com/u/0/+VivekRaikgp?rel=author"></a>- Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a><br>
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="../cc-by-sa4.png"></a>

    
    </div>
</div>
    <ul class="social-icons">
        
<li> <a href="https://github.com/vivekiitkgp/"> <i class="fa fa-github"></i> </a> </li>
<li> <a href="http://stackoverflow.com/users/1910171/vivek-rai"> <i class="fa fa-stack-overflow"></i> </a> </li>
<li> <a href="http://in.linkedin.com/pub/vivek-rai/58/505/130/"> <i class="fa fa-linkedin"></i> </a> </li>
<li> <a href="https://plus.google.com/u/0/+vivekraikgp"> <i class="fa fa-google-plus"></i> </a> </li>
<li> <a href="https://twitter.com/vivek_ziel"> <i class="fa fa-twitter"></i> </a> </li>

    </ul>
    
            <script src="../assets/js/all-nocdn.js"></script>
     

    <script type="text/javascript" src="../assets/js/jquery.sharrre-1.3.4.min.js"></script>
    <script type="text/javascript">
        /* jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"80%",maxHeight:"80%",scalePhotos:true}); */
        $('#share').sharrre({
        share: {
            googlePlus: true,
            twitter: true
        },
        buttons: {
            googlePlus: {annotation:'bubble'},
            twitter: {count: 'horizontal'}
        },
        hover: function(api, options){
            $(api.element).find('.buttons').show();
        },
        hide: function(api, options){
            $(api.element).find('.buttons').hide();
        },
        enableTracking: true,
        urlCurl: ""
        });
    </script>
    
<script>
$('li>a', '.social-icons').hover(
       function(){ $(this).addClass('tossing') },
       function(){ $(this).removeClass('tossing') }
)
</script>

    
</body>
</html>
